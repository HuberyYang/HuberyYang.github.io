I"¥_<blockquote>
  <p>èµ°åŠ¿å›¾æ˜¯å½©ç¥¨ä¸­ç»¼åˆå¤šæœŸå¼€å¥–ç»“æœå¾—å‡ºæ¯ä¸ªæŠ•æ³¨å·ç çš„é—æ¼å€¼ã€å‡ºç°æ¬¡æ•°ã€å¹³å‡é—æ¼ã€æœ€å¤§é—æ¼ç­‰å€¼ç„¶åå±•ç¤ºçš„è¡¨æ ¼è§†å›¾ã€‚è¿™é‡Œåªåšäº†åŒè‰²çƒè“çƒçš„èµ°åŠ¿å›¾ï¼Œå…¶å®ƒå½©ç§çš„èµ°åŠ¿å›¾ä¸æ­¤ç±»ä¼¼ã€‚</p>
</blockquote>

<p>å…ˆçœ‹æ•ˆæœå›¾ï¼š</p>

<p><img src="http://upload-images.jianshu.io/upload_images/2475558-467c214ecafb2d2c.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="trend.gif" /></p>

<p><strong>å¸ƒå±€</strong></p>

<p>å¸ƒå±€åˆ†ä¸‰éƒ¨åˆ†ï¼š</p>

<ol>
  <li>
    <p>é¡¶éƒ¨å·ç åŒº â€“ ä½¿ç”¨<code class="highlighter-rouge">UIScrollView</code></p>
  </li>
  <li>
    <p>å·¦ä¾§æœŸå·åŒº â€“ ä½¿ç”¨<code class="highlighter-rouge">UITableView</code></p>
  </li>
  <li>
    <p>å³ä¾§å·ç åŒº â€“ ä½¿ç”¨<code class="highlighter-rouge">UICollectionView</code></p>
  </li>
</ol>

<p><strong>åˆ†æ­¥å¤„ç†</strong></p>

<ul>
  <li>æ»‘åŠ¨æ—¶éœ€è¦ä½¿ä¸‰å¤§å—åœ¨ x/y è½´åç§»é‡ä¿æŒä¸€è‡´
å¯ä»¥åœ¨ <code class="highlighter-rouge">scrollViewDidScroll</code> ä¸­è¿›è¡Œæ§åˆ¶</li>
</ul>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">scrollViewDidScroll</span><span class="p">:(</span><span class="n">UIScrollView</span> <span class="o">*</span><span class="p">)</span><span class="nv">scrollView</span><span class="p">{</span>
    <span class="n">CGPoint</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">scrollView</span><span class="p">.</span><span class="n">contentOffset</span><span class="p">;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">scrollView</span> <span class="o">==</span> <span class="n">self</span><span class="p">.</span><span class="n">issueList</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// å·¦</span>
    
        <span class="n">self</span><span class="p">.</span><span class="n">numberList</span><span class="p">.</span><span class="n">contentOffset</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">numberList</span><span class="p">.</span><span class="n">contentOffset</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">offset</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">scrollView</span> <span class="o">==</span> <span class="n">self</span><span class="p">.</span><span class="n">numberList</span><span class="p">){</span> <span class="c1">// å³</span>
    
        <span class="n">self</span><span class="p">.</span><span class="n">issueList</span><span class="p">.</span><span class="n">contentOffset</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">issueList</span><span class="p">.</span><span class="n">contentOffset</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">offset</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ballsPagView</span><span class="p">.</span><span class="n">contentOffset</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">numberList</span><span class="p">.</span><span class="n">contentOffset</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">ballsPagView</span><span class="p">.</span><span class="n">contentOffset</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">scrollView</span> <span class="o">==</span> <span class="n">self</span><span class="p">.</span><span class="n">ballsPagView</span><span class="p">){</span> <span class="c1">// ä¸Š</span>
    
        <span class="n">self</span><span class="p">.</span><span class="n">numberList</span><span class="p">.</span><span class="n">contentOffset</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">ballsPagView</span><span class="p">.</span><span class="n">contentOffset</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">numberList</span><span class="p">.</span><span class="n">contentOffset</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li>å³ä¾§å·ç åŒºå¸ƒå±€
å³ä¾§ <code class="highlighter-rouge">UICollectionView</code> çš„ <code class="highlighter-rouge">contentSize</code> å·²ç»è¶…å‡ºäº†é»˜è®¤å¸ƒå±€çš„èŒƒå›´ï¼ŒäºŒä½é»˜è®¤å¸ƒå±€ä¹Ÿä¸åˆ°è¾¾åˆ°å›¾ç¤ºä¸­åŒå‘æ»‘åŠ¨çš„æ•ˆæœï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ <code class="highlighter-rouge">layout </code>è‡ªå®šä¹‰å¸ƒå±€ã€‚
åˆ›å»ºç»§æ‰¿è‡ª<code class="highlighter-rouge">UICollectionViewLayout</code>çš„<code class="highlighter-rouge">SSQTrendLayout</code>ç±»è¿›è¡Œè‡ªå®šä¹‰å¸ƒå±€ã€‚</li>
</ul>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#import "SSQTrendLayout.h"
</span>
<span class="k">@implementation</span> <span class="nc">SSQTrendLayout</span><span class="p">{</span>
    
    <span class="n">NSMutableArray</span> <span class="o">*</span><span class="n">_attributes</span><span class="p">;</span>
    <span class="n">NSInteger</span> <span class="n">_itemCount</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">prepareLayout</span><span class="p">{</span>
    <span class="p">[</span><span class="n">super</span> <span class="nf">prepareLayout</span><span class="p">];</span>
    
    <span class="n">_itemCount</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">collectionView</span> <span class="nf">numberOfSections</span><span class="p">];</span>
    <span class="n">_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableArray</span> <span class="nf">array</span><span class="p">];</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">_itemCount</span><span class="p">;</span> <span class="n">index</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSInteger</span> <span class="n">pSec</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">collectionView</span> <span class="nf">numberOfItemsInSection</span><span class="p">:</span><span class="n">index</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">pSec</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            
            <span class="n">NSIndexPath</span> <span class="o">*</span><span class="n">indexPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSIndexPath</span> <span class="nf">indexPathForItem</span><span class="p">:</span><span class="n">i</span> <span class="nf">inSection</span><span class="p">:</span><span class="n">index</span><span class="p">];</span>
            <span class="n">UICollectionViewLayoutAttributes</span> <span class="o">*</span><span class="n">pAttri</span> <span class="o">=</span> <span class="p">[</span><span class="n">UICollectionViewLayoutAttributes</span> <span class="nf">layoutAttributesForCellWithIndexPath</span><span class="p">:</span><span class="n">indexPath</span><span class="p">];</span>
            
            <span class="n">CGFloat</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="n">CGFloat</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            
            <span class="c1">// æ¯ä¸ªitemçš„å®½é«˜</span>
            
            <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kItemSize</span><span class="p">.</span><span class="n">width</span><span class="p">);</span>
            <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">index</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kItemSize</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
            <span class="n">pAttri</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kItemSize</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">kItemSize</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
            
            <span class="p">[</span><span class="n">_attributes</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">pAttri</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span> 
<span class="p">}</span>

<span class="c1">// è®¾ç½®å†…å®¹åŒºåŸŸçš„å¤§å°</span>

<span class="k">-</span> <span class="p">(</span><span class="n">CGSize</span><span class="p">)</span><span class="n">collectionViewContentSize</span><span class="p">{</span>

    <span class="c1">// sections</span>
    
    <span class="n">NSInteger</span> <span class="n">sec</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">collectionView</span> <span class="nf">numberOfSections</span><span class="p">];</span>
    <span class="k">return</span> <span class="n">CGSizeMake</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">cols</span> <span class="o">*</span> <span class="n">kItemSize</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">sec</span> <span class="o">*</span> <span class="p">(</span><span class="n">kItemSize</span><span class="p">.</span><span class="n">height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="n">NSArray</span><span class="o">&lt;</span><span class="n">UICollectionViewLayoutAttributes</span> <span class="o">*&gt;</span> <span class="o">*</span><span class="p">)</span><span class="nf">layoutAttributesForElementsInRect</span><span class="p">:(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">rect</span><span class="p">{</span>
    <span class="k">return</span> <span class="n">_attributes</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@end</span>

</code></pre></div></div>

<ul>
  <li>
    <p>å³ä¾§å·ç åŒºcellå¤„ç†</p>

    <blockquote>
      <p>é€šå¸¸æ–‡æœ¬çš„æ˜¾ç¤ºç”¨<code class="highlighter-rouge">UILabel</code>å°±å¯ä»¥äº†ï¼Œä½†è¿™é‡Œç”±äºé¡µé¢å†…cellæ•°é‡ä¼—å¤šï¼Œå¹¶ä¸”éƒ¨åˆ†cellä¸Šè¿˜éœ€è¦åœ†å½¢èƒŒæ™¯ï¼Œä½¿ç”¨<code class="highlighter-rouge">UILabel</code>ä¼šé€ æˆæ˜æ˜¾çš„å¡é¡¿ï¼Œè¿™é‡Œç›´æ¥åœ¨cellä¸Šç»˜åˆ¶æ‰€éœ€çš„èƒŒæ™¯å’Œæ–‡å­—ã€‚</p>
    </blockquote>
  </li>
</ul>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">drawRect</span><span class="p">:(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">rect</span><span class="p">{</span>
    
    <span class="c1">// åˆ›å»ºç”»å¸ƒ</span>
    
    <span class="n">CGContextRef</span> <span class="n">context</span> <span class="o">=</span> <span class="n">UIGraphicsGetCurrentContext</span><span class="p">();</span>
    
    <span class="c1">// è®¾ç½®å¡«å……è‰²</span>
    
    <span class="n">CGContextSetFillColorWithColor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">bgColor</span><span class="p">.</span><span class="n">CGColor</span><span class="p">);</span>
    
    <span class="c1">// åœ†å½¢ç›´å¾„</span>
    
    <span class="n">CGFloat</span> <span class="n">w</span> <span class="o">=</span> <span class="n">MIN</span><span class="p">(</span><span class="n">kItemSize</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">kItemSize</span><span class="p">.</span><span class="n">height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">;</span>
    
    <span class="c1">// å›­ç‚¹åæ ‡</span>
    
    <span class="n">CGPoint</span> <span class="n">center</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">rect</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">rect</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">shapeType</span> <span class="o">==</span> <span class="n">ShapeWithBackgroundViewRound</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// åœ†å½¢èƒŒæ™¯</span>
        
        <span class="n">CGContextAddArc</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">center</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">center</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M_PI</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">CGContextDrawPath</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">kCGPathFill</span><span class="p">);</span>
        <span class="p">[</span><span class="n">self</span> <span class="nf">drawShowText</span><span class="p">];</span>
    <span class="p">}</span><span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">shapeType</span> <span class="o">==</span> <span class="n">ShapeWithNoBackgroundView</span><span class="p">){</span> <span class="c1">// æ— èƒŒæ™¯</span>
    
        <span class="p">[</span><span class="n">self</span> <span class="nf">drawShowText</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ç»˜åˆ¶æ–‡å­—</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">drawShowText</span><span class="p">{</span>
    
    <span class="n">UIFont</span> <span class="o">*</span><span class="n">font</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIFont</span> <span class="nf">systemFontOfSize</span><span class="p">:</span><span class="mi">12</span><span class="p">];</span>
    <span class="n">CGSize</span> <span class="n">textSize</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">number</span> <span class="nf">sizeWithAttributes</span><span class="p">:@{</span><span class="n">NSFontAttributeName</span><span class="o">:</span><span class="n">font</span><span class="p">}];</span>
    <span class="n">CGRect</span> <span class="n">textRect</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">textSize</span><span class="p">.</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">textSize</span><span class="p">.</span><span class="n">height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">number</span> <span class="nf">drawInRect</span><span class="p">:</span><span class="n">textRect</span> <span class="nf">withAttributes</span><span class="p">:@{</span><span class="n">NSFontAttributeName</span><span class="o">:</span><span class="n">font</span><span class="p">,</span><span class="n">NSForegroundColorAttributeName</span><span class="o">:</span><span class="n">self</span><span class="p">.</span><span class="n">textColor</span><span class="p">}];</span>
<span class="p">}</span>
</code></pre></div></div>
<p>è€ƒè™‘åˆ°cellçš„é‡ç”¨ç‰¹æ€§ï¼Œéœ€è¦åœ¨<code class="highlighter-rouge">UICollectionView</code>ä»£ç†æ–¹æ³•è·å–cellæ—¶é‡æ–°ç»˜åˆ¶:</p>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">cell</span> <span class="nf">setNeedsDisplay</span><span class="p">];</span>
<span class="k">return</span> <span class="n">cell</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å¼€å¥–å·ç è¿æ¥çº¿</li>
</ul>

<p>å¼€å¥–å·ç è¿æ¥çº¿éœ€è¦ç›´æ¥æ·»åŠ äº<code class="highlighter-rouge">UICollectionView</code>çš„layerå›¾å±‚ä¸Šï¼Œä»¥ä¿è¯çº¿æ®µä¸åˆ—è¡¨cellç›¸å¯¹ä½ç½®çš„æ­£ç¡®,è€Œçº¿æ®µå¯ä»¥é‡‡ç”¨ <code class="highlighter-rouge">UIBezierPath</code>ä¸<code class="highlighter-rouge">CAShapeLayer</code> ç»“åˆçš„æ–¹å¼ç»˜åˆ¶ã€‚</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// ç»˜åˆ¶æŠ˜çº¿
- (void)drawBrokenLines{
    
    // è®¡ç®—çº¿æ®µå¼€å§‹ç‚¹ä¸ç»“æŸç‚¹
    NSMutableArray &lt;TrendPerBall *&gt; *ballsPoints = [NSMutableArray array];
    for (int sec = 0; sec &lt; self.listSource.count; sec ++) {
        SSQTrendModel *tm = self.listSource[sec];
        NSArray *showBalls = tm.trends.lastObject;
        for (int row = 0; row &lt; showBalls.count; row ++) {
            
            TrendPerBall *pb = showBalls[row];
            CGFloat x = 0;
            CGFloat y = 0;
            
            // æ¯ä¸ªitemçš„å®½é«˜ï¼Œéœ€è¦ä¸layoutä¸­itemçš„frameä¿æŒä¸€è‡´
            x = row * (1 + kItemSize.width);
            y = 1 + sec * (1 + kItemSize.height);
            CGRect pFrame = CGRectMake(x, y, kItemSize.width, kItemSize.height);
            CGPoint pCenter = CGPointMake(pFrame.origin.x + pFrame.size.width / 2.0,
                                          pFrame.origin.y + pFrame.size.height / 2.0);
            
            pb.realRect = pFrame;
            pb.center = pCenter;
            
            if (pb.isAwardNumber) {
                [ballsPoints addObject:pb];
            }
        }
    }
    
    // èŠ‚ç‚¹åœ†å½¢åŠå¾„
    CGFloat r = (MIN(kItemSize.width, kItemSize.height) - 4) / 2.0;
    // è®¡ç®—ç»˜åˆ¶çº¿æ®µçš„å¼€å§‹ç‚¹å’Œç»“æŸç‚¹
    for (int index = 0; index &lt; ballsPoints.count - 1; index ++) {
        
        TrendPerBall *fm = ballsPoints[index];
        TrendPerBall *tm = ballsPoints[index + 1];
        // èŠ‚ç‚¹é—´è·
        CGFloat dis = sqrt(pow(tm.center.x - fm.center.x, 2.0) + pow(tm.center.y - fm.center.y, 2.0));
        if (tm.center.x &lt;= fm.center.x) { // ä¸‹ä¸ªèŠ‚ç‚¹ä½äºç¬¬ä¸Šä¸ªèŠ‚ç‚¹å·¦ä¾§
            
            fm.startPoint = CGPointMake(fm.center.x - r * ((fm.center.x - tm.center.x) / dis),
                                        fm.center.y + r * ((tm.center.y - fm.center.y) / dis));
            
            tm.endPoint   = CGPointMake(tm.center.x + r * ((fm.center.x - tm.center.x) / dis),
                                        tm.center.y - r * ((tm.center.y - fm.center.y) / dis));
            
        }else{ // ä¸‹ä¸ªèŠ‚ç‚¹ä½äºç¬¬ä¸Šä¸ªèŠ‚ç‚¹å³ä¾§
            
            fm.startPoint = CGPointMake(fm.center.x + r * ((tm.center.x - fm.center.x) / dis),
                                        fm.center.y + r * ((tm.center.y - fm.center.y) / dis));
            
            tm.endPoint   = CGPointMake(tm.center.x - r * ((tm.center.x - fm.center.x) / dis),
                                        tm.center.y - r * ((tm.center.y - fm.center.y) / dis));
        }
        
        UIBezierPath *path = [[UIBezierPath alloc] init];
        [path moveToPoint:fm.startPoint];
        [path addLineToPoint:tm.endPoint];
        
        CAShapeLayer *layer = [CAShapeLayer layer];
        layer.path = path.CGPath;
        layer.strokeColor = kBLUE_COLOR.CGColor;
        layer.fillColor = [UIColor clearColor].CGColor;
        layer.lineWidth = 1;
        layer.lineCap = kCALineJoinRound;
        layer.lineJoin = kCALineJoinRound;
        
        [self.numberList.layer addSublayer:layer];
    }
}
</code></pre></div></div>

<p>ä»¥ä¸Šå³ä¸ºèµ°åŠ¿å›¾ä¸­è¾ƒé‡è¦çš„éƒ¨åˆ†ï¼Œå®Œæ•´çš„Demoåœ°å€ï¼š<a href="https://github.com/HuberyYang/LotteryTrend.git">LotteryTrend</a>
å¦‚æœæœ¬ç¯‡æ–‡ç« èƒ½å¸®åˆ°æ‚¨ï¼Œè¯·æ‚¨éšæ‰‹ä¸¢ä¸ªstar</p>

:ET