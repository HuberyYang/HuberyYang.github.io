--- 
layout:     post                      
title:      flutter è¿ç‚¹æ‰‹åŠ¿
subtitle:   flutter æ‰‹åŠ¿å¯è¿ç»­ç‚¹å‡»
keywords:   flutterã€æ‰‹åŠ¿ã€è¿ç‚¹
date:       2021-03-18                
author:     HuberyYang                
header-img: img/article_head_road.jpg
catalog:    true                     
tags:
   - flutter                            
---

flutter æ ‡å‡†åº“ä¸­ `GestureDetector` æ˜¯ä¸æ”¯æŒè¿ç‚¹çš„ï¼Œä½†æ˜¯ç°åœ¨æœ‰éœ€è¦ç”¨ï¼Œæ€ä¹ˆæ•´å‘¢ï¼Œé‚£å°±åœ¨ `GestureDetector` åŸºç¡€ä¸Šå°è£…ä¸€ä¸ªå¥½äº†ğŸ˜„

```
import 'package:flutter/material.dart';

// è¿ç‚¹æ‰‹åŠ¿
class ContinuousTapGestureDetector extends GestureDetector {
  final Widget child;
  final ContinuousTapListener listener; // è¿ç‚¹ç›‘å¬è€…

  ContinuousTapGestureDetector({@required this.child,  @required this.listener}) : super(child: child, onTap: () {
    listener.onTapListening();
  });
}

class ContinuousTapListener {
  final int numberOfTapsRequired; // éœ€è¦è¿ç‚¹çš„æ¬¡æ•°ï¼Œ é»˜è®¤ä¸º 1 æ¬¡
  final void Function() onContinuousTap; // æ»¡è¶³è¿ç‚¹æ¡ä»¶æ—¶çš„å›è°ƒ

  int _lastTapTime = 0; // ä¸Šä¸€æ¬¡ç‚¹å‡»çš„æ—¶é—´æˆ³
  int _numberOfTapRecorded = 0; // å·²è®°å½•çš„ç‚¹å‡»æ¬¡æ•°
  int _maxMillisecondsBetweenTwoTaps = 350;// ä¸¤æ¬¡ç‚¹å‡»çš„æœ€å¤§æ—¶é—´é—´éš”

  ContinuousTapListener({this.numberOfTapsRequired = 1, this.onContinuousTap});

  void onTapListening() {
    final now = DateTime.now().millisecondsSinceEpoch;
    if (_lastTapTime > 0 && now - _lastTapTime > _maxMillisecondsBetweenTwoTaps) {
      _resetRecord(time: now, count: 1);
    } else {
      _lastTapTime = now;
      _numberOfTapRecorded += 1;
      _checkAvailable();
    }
  }

  // é‡ç½®è®°å½•
  void _resetRecord({int time = 0, int count = 0}) {
    _lastTapTime = time;
    _numberOfTapRecorded = count;
  }

  // éªŒè¯æ˜¯å¦æ»¡è¶³é¢„è®¾æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³åˆ™æ‰§è¡Œå›è°ƒå‡½æ•°
  void _checkAvailable() {
    if (_numberOfTapRecorded >= numberOfTapsRequired) {
      _resetRecord();
      if (onContinuousTap != null) {
        onContinuousTap();
      }
    }
  }
}
```

ä½¿ç”¨ä¹Ÿæ¯”è¾ƒç®€å•

```
ContinuousTapGestureDetector(
	child: Text('ç‚¹ç‚¹ç‚¹'),
	listener: ContinuousTapListener(
		numberOfTapsRequired: 8,
		onContinuousTap: () {
			Get.toNamed(AppPages.APP_ENV);
		},
	),
),
```